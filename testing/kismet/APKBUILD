# Contributor: Katie Holly <holly@fuslvz.ws>
# Maintainer: Katie Holly <holly@fuslvz.ws>
pkgname=kismet
pkgver=2016.07.r1
_pkgver=${pkgver//./-}
_pkgver=${_pkgver/r/R}
pkgrel=0
pkgdesc="Kismet is a wireless network detector, sniffer, and intrusion detection system."
url="https://www.kismetwireless.net/"
arch="all"
license="GPL-2.0-only"
depends=""
makedepends="xz ncurses-dev linux-headers libpcap-dev libnl-dev pcre-dev"
install=""
source="
	https://www.kismetwireless.net/code/$pkgname-$_pkgver.tar.xz
	$pkgname-musl.patch
	$pkgname.pre-install
	$pkgname.post-install
	"
builddir="$srcdir"/$pkgname-$_pkgver
subpackages="$pkgname-doc"
options="!check" # upstream software package doesn't provide any tests

build() {
	cd "$builddir"
	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" commoninstall
	install -Dm550 -c -o root -g root "$builddir"/kismet_capture "$pkgdir"/usr/bin/kismet_capture
	install -Dm644 "$builddir"/conf/$pkgname.conf.in "$pkgdir"/etc/$pkgname.conf
}

sha512sums="88891a0cd5ef94a4815d259e433f946f52552c125e05a5d8ac447d04e6090f2bd92f8bd8573440f0dfe446b29233bef81d9889e53170757ad0116ddfc2cb8416  kismet-2016-07-R1.tar.xz
ee9fef48acc5b37aaff214724abf6993bd2a2621d33f9323aac6ce18185ce3acfdde2ba25f498150cd9a7678815811af9852bf158c7a9600e9a766facab8e216  kismet-musl.patch
fac8d605b725522a2c262d623c3cad5789448a0a5624d7bdf39839ad6502a76e81c772c917f8425f4fafa79733286927b4000a07bee5a50aa1048858418045cc  kismet.pre-install
4c4748d5d3527f17952550e7a56fe7272c8fe05c3998ff9516b1231b720bc2110fde8a3a50dbfc2dde7c3db0216845fa7472282d2a740c59f70ab34bd0a0e5d6  kismet.post-install"
